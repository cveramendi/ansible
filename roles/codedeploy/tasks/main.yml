---
# tasks file for codedeploy
- name: Upgrade all packages
  yum:
    name: "*"
    state: latest

- name: Install python35
  yum:
    name: python35
    state: present

- name: Install ruby
  yum:
    name: ruby
    state: present

- name: Install wget
  yum:
    name: wget
    state: present

# tasks file for helloworld
- name: Copying the installAgent.sh file
  copy:
    src: installAgent.sh
    dest: /home/ec2-user/
    owner: ec2-user
    group: ec2-user
    mode: 0644

- name: Install CodeDeploy Agent shell
  shell: /home/ec2-user/installAgent.sh > /home/ec2-user/agentInstallLog.txt

- name: Start CodeDeploy Agent
  service:
    name: codedeploy-agent
    enabled: true
    state: started
